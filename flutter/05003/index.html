<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Windows Mouse Click Animation (Lottie)
  #


  What is it?
  #

Adding mouse click or touch motion in a Flutter app is no big deal. But what about apps running on Windows 10? If you can use Lottie animations, you could turn boring click motions into something that feels like a macOS app…
Windows has a long history, but since Vista, I haven’t really come across programs or open-source projects that deal with click animations. Sure, it’s mostly a trivial feature, but the built-in Windows functionality is just… terrible.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark">
<meta name="google-adsense-account" content="ca-pub-7362089186642274">
<meta name="naver-site-verification" content="836a15f31b5398a85626d8b06558547bcadd8a4c" />
<meta name="google-site-verification" content="qCBCvelNiGg9-YydwmAkQziJ_pgLxNRTyRKQiCzQo_A" /><meta property="og:url" content="https://mcjoi.github.io/flutter/05003/">
  <meta property="og:site_name" content="shaaaaallow Dive">
  <meta property="og:title" content="[result] Windows Mouse Click Animation">
  <meta property="og:description" content="Windows Mouse Click Animation (Lottie) # What is it? # Adding mouse click or touch motion in a Flutter app is no big deal. But what about apps running on Windows 10? If you can use Lottie animations, you could turn boring click motions into something that feels like a macOS app…
Windows has a long history, but since Vista, I haven’t really come across programs or open-source projects that deal with click animations. Sure, it’s mostly a trivial feature, but the built-in Windows functionality is just… terrible.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="flutter">
    <meta property="article:published_time" content="2025-08-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-28T00:00:00+00:00">
    <meta property="article:tag" content="Flutter">
<title>[result] Windows Mouse Click Animation | shaaaaallow Dive</title>
<link rel="icon" href="https://mcjoi.github.io/favicon.png" >
<link rel="manifest" href="https://mcjoi.github.io/manifest.json">
<link rel="canonical" href="https://mcjoi.github.io/flutter/05003/">
<link rel="stylesheet" href="https://mcjoi.github.io/book.min.6df302c8bc5d2595cc699a90f1d272c30374b7c5279311d7105e03311d3edc4c.css" integrity="sha256-bfMCyLxdJZXMaZqQ8dJywwN0t8UnkxHXEF4DMR0&#43;3Ew=" crossorigin="anonymous">
  <script defer src="https://mcjoi.github.io/fuse.min.js"></script>
  <script defer src="https://mcjoi.github.io/en.search.min.965996a0fefd62443a0fa64a223072d7857ae48802e768965b154028c360dda1.js" integrity="sha256-llmWoP79YkQ6D6ZKIjBy14V65IgC52iWWxVAKMNg3aE=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7362089186642274"
     crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-MCBX55V1KD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MCBX55V1KD');
</script>

<script type="text/javascript" src="//wcs.naver.net/wcslog.js"></script>
<script type="text/javascript">
if(!wcs_add) var wcs_add = {};
wcs_add["wa"] = "14fdea2e7a4d6b0";
if(window.wcs) {
  wcs_do();
}
</script>




  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="https://mcjoi.github.io/"><span>shaaaaallow Dive</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>






  <li class="">
    <a href="https://mcjoi.github.io/macrotoolkit-xls/">MacroToolkit-Excel</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/macrotoolkit-ppt/">MacroToolkit-PPT</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/vba/">VBA</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/python/">Python</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/flutter/">Flutter</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/windows_linux/">Windows_Linux</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/life/">Life</a>
  </li>

  <li class="">
    <a href="https://mcjoi.github.io/gallery/">Gallery</a>
  </li>









  <div class="sidebar-post-list">
    <h3>Flutter</h3>
    <ul>
      
        <li>
          <a href="https://mcjoi.github.io/flutter/05001/" >
            [note] Init Flutter APIs
          </a>
        </li>
      
        <li>
          <a href="https://mcjoi.github.io/flutter/05002/" >
            [result] Windows Desktop Shortcut
          </a>
        </li>
      
        <li>
          <a href="https://mcjoi.github.io/flutter/05003/" class="active">
            [result] Windows Mouse Click Animation
          </a>
        </li>
      
        <li>
          <a href="https://mcjoi.github.io/flutter/05004/" >
            [note] Hiding Google API key
          </a>
        </li>
      
    </ul>
  </div>

































  
  <ul>
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="https://mcjoi.github.io/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>[result] Windows Mouse Click Animation</h3>

  <label for="toc-control">
    
    <img src="https://mcjoi.github.io/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-it">What is it?</a></li>
    <li><a href="#two-scenarios">Two Scenarios</a></li>
    <li><a href="#win32-and-ffi">Win32 and FFI</a></li>
    <li><a href="#scenario-details">Scenario Details</a></li>
    <li><a href="#packages-used">Packages Used</a></li>
    <li><a href="#calling-the-dll">Calling the DLL</a></li>
    <li><a href="#lottie-animation">Lottie Animation</a></li>
    <li><a href="#result">Result</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  
  <article class="markdown book-article"><h1 id="windows-mouse-click-animation-lottie">
  Windows Mouse Click Animation (Lottie)
  <a class="anchor" href="#windows-mouse-click-animation-lottie">#</a>
</h1>
<h2 id="what-is-it">
  What is it?
  <a class="anchor" href="#what-is-it">#</a>
</h2>
<p>Adding mouse click or touch motion in a Flutter app is no big deal. But what about apps running on Windows 10? If you can use Lottie animations, you could turn boring click motions into something that feels like a macOS app…</p>
<p>Windows has a long history, but since Vista, I haven’t really come across programs or open-source projects that deal with click animations. Sure, it’s mostly a trivial feature, but the built-in Windows functionality is just… terrible.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2F8Khaq%2FbtsMWk49PJw%2FAAAAAAAAAAAAAAAAAAAAAAnMV4AKSKo7xX1ASvBkH4pAoZfsK9fIVDs11wIzR_wA%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1756652399%26allow_ip%3D%26allow_referer%3D%26signature%3D%252FcMuUOOB0cw%252FOVKcWgyOkEIzdRk%253D" alt="&ldquo;image&rdquo;" title="image"/></p>
<p>Still, I decided to give it a try.</p>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FdAXYP0%2FbtsMW9VRf82%2FAAAAAAAAAAAAAAAAAAAAAPxl94lCwv9F75U9-EEltTZVy68lPB0fIMTtTWgOBOSQ%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DdVVCf9LgoGfVK8zNsyeCcLjd0U8%253D" alt="&ldquo;image&rdquo;" title="image"/></p>
<hr>
<h2 id="two-scenarios">
  Two Scenarios
  <a class="anchor" href="#two-scenarios">#</a>
</h2>
<ol>
<li>
<p>Send the click coordinates from Windows to Flutter<br>
You run the Flutter app as an invisible layer, and when click coordinates are received, it plays an animation.</p>
</li>
<li>
<p>Send the clicked coordinates from Flutter to Windows<br>
Flutter plays the animation, and the coordinates sent to Windows trigger the actual click.</p>
</li>
</ol>
<p>These are simple scenarios, but ChatGPT recommended #2. Following that advice led to a few days of trial and error. Eventually, I realized that #1 is the reliable approach.</p>
<hr>
<h2 id="win32-and-ffi">
  Win32 and FFI
  <a class="anchor" href="#win32-and-ffi">#</a>
</h2>
<p>On Flutter Android, whenever you try to do anything, you often need to touch native code—and it can easily break. Windows is no different: you have to deal with C++.</p>
<p>There are two ways to do this: write everything in Dart, or build a C++ DLL in Visual Studio and call it from Flutter.</p>
<p>Since I had no idea if it would even work, I did it for fun. Otherwise, I would have given up immediately.</p>
<hr>
<h2 id="scenario-details">
  Scenario Details
  <a class="anchor" href="#scenario-details">#</a>
</h2>
<ol>
<li>Flutter runs the DLL file.</li>
<li>Windows, via the DLL, writes click coordinates to a text file whenever a click occurs.</li>
<li>Flutter reads the coordinates from the text file and uses them to determine where to play the animation.</li>
<li>The Flutter app runs fullscreen with a transparent background, in the background.
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fbxs4XD%2FbtsMVutHh6G%2FAAAAAAAAAAAAAAAAAAAAAP27oCRpsbPwaD9Ia8i5do25DAU62a1f7Tz9iLuWX_hY%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1756652399%26allow_ip%3D%26allow_referer%3D%26signature%3DvMiT6U0Mm5M0i4Aipzt5qdDHzLc%253D" alt="&ldquo;image&rdquo;" title="image"/></li>
</ol>
<hr>
<h2 id="packages-used">
  Packages Used
  <a class="anchor" href="#packages-used">#</a>
</h2>
<p>For controlling the DLL, we just import io and ffi. For window management, we use window_manager. To play animations, we use the lottie package.</p>
<hr>
<h2 id="calling-the-dll">
  Calling the DLL
  <a class="anchor" href="#calling-the-dll">#</a>
</h2>
<p>The DLL must be executed from main(). I didn’t know why, but following ChatGPT’s instructions, it should be defined like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> StartHookThreadC <span style="color:#f92672">=</span> Void Function();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> StartHookThreadDart <span style="color:#f92672">=</span> <span style="color:#66d9ef">void</span> Function();
</span></span></code></pre></div><p>You run the startHookThread function. Its only function is to save click coordinates in C:\temp. Flutter only reads the coordinates saved in the text file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> dylib <span style="color:#f92672">=</span> DynamicLibrary.open(<span style="color:#e6db74">&#39;click_hooking.dll&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> StartHookThreadDart startHookThread <span style="color:#f92672">=</span> dylib
</span></span><span style="display:flex;"><span>      .lookupFunction<span style="color:#f92672">&lt;</span>StartHookThreadC, StartHookThreadDart<span style="color:#f92672">&gt;</span>(<span style="color:#e6db74">&#39;StartHookThread&#39;</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>startHookThread();
</span></span></code></pre></div><hr>
<h2 id="lottie-animation">
  Lottie Animation
  <a class="anchor" href="#lottie-animation">#</a>
</h2>
<p>Rive provides incredible features, but Lottie just runs animations—and that’s perfect. You don’t need a full authoring tool like Rive to create animations; After Effects and Bodymovin can handle it.</p>
<p>By using a Stack with Positioned widgets, you can play click animations exactly where you want, ending this tedious setup.</p>
<p>First, here’s the <code>C++</code> source code that needs to be built as a <code>DLL</code> using Visual Studio.</p>

<blockquote class='book-hint '>
  <p>mouse_hook.cpp</p>
</blockquote><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;pch.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;fstream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>HHOOK mouseHook;
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>string outputPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C:</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">Temp</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">click_position.txt&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LRESULT CALLBACK <span style="color:#a6e22e">MouseProc</span>(<span style="color:#66d9ef">int</span> nCode, WPARAM wParam, LPARAM lParam) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (nCode <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> wParam <span style="color:#f92672">==</span> WM_LBUTTONDOWN) {
</span></span><span style="display:flex;"><span>        MSLLHOOKSTRUCT<span style="color:#f92672">*</span> mouseInfo <span style="color:#f92672">=</span> (MSLLHOOKSTRUCT<span style="color:#f92672">*</span>)lParam;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> mouseInfo<span style="color:#f92672">-&gt;</span>pt.x;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> mouseInfo<span style="color:#f92672">-&gt;</span>pt.y;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        std<span style="color:#f92672">::</span>ofstream out(outputPath);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (out.is_open()) {
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">&lt;&lt;</span> y;
</span></span><span style="display:flex;"><span>            out.close();
</span></span><span style="display:flex;"><span><span style="color:#75715e">//            log(&#34;Click detected: &#34; + std::to_string(x) + &#34;,&#34; + std::to_string(y));
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> CallNextHookEx(mouseHook, nCode, wParam, lParam);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetClickHook</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// log(&#34;SetClickHook called&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    HMODULE hInstance <span style="color:#f92672">=</span> GetModuleHandle(NULL);
</span></span><span style="display:flex;"><span>    mouseHook <span style="color:#f92672">=</span> SetWindowsHookEx(WH_MOUSE_LL, MouseProc, hInstance, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (mouseHook <span style="color:#f92672">==</span> NULL) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//log(&#34;Failed to set mouse hook&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        MessageBoxW(NULL, <span style="color:#e6db74">L</span><span style="color:#e6db74">&#34;Failed to set hook&#34;</span>, <span style="color:#e6db74">L</span><span style="color:#e6db74">&#34;Error&#34;</span>, MB_ICONERROR);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//log(&#34;Mouse hook successfully set&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    MSG msg;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (GetMessage(<span style="color:#f92672">&amp;</span>msg, NULL, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)) {
</span></span><span style="display:flex;"><span>        TranslateMessage(<span style="color:#f92672">&amp;</span>msg);
</span></span><span style="display:flex;"><span>        DispatchMessage(<span style="color:#f92672">&amp;</span>msg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// log(&#34;Message loop exited&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> RemoveClickHook() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (mouseHook) {
</span></span><span style="display:flex;"><span>        UnhookWindowsHookEx(mouseHook);
</span></span><span style="display:flex;"><span>       <span style="color:#75715e">// log(&#34;Mouse hook removed&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DWORD WINAPI <span style="color:#a6e22e">HookThreadProc</span>(LPVOID) {
</span></span><span style="display:flex;"><span>    SetClickHook();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> StartHookThread() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//  log(&#34;Starting hook thread...&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    CreateThread(NULL, <span style="color:#ae81ff">0</span>, HookThreadProc, NULL, <span style="color:#ae81ff">0</span>, NULL);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p> </p>
<p>On the Flutter side, there isn’t much to configure, but calling the <code>DLL</code> itself was a bit unfamiliar.</p>
<p>Also, even when using a dual-monitor setup, I limited the mouse click animation to appear only within the range from coordinate (0,0) up to 1920×1080.</p>
<p>For the Lottie animation specified in <code>assets/click2.json</code>, make sure to update the file name if necessary. Alternatively, you could add a feature to dynamically select different motions. Currently, the default animation duration is set to under 0.8 seconds. If you use a different animation length, you’ll need to adjust the duration code accordingly.</p>

<blockquote class='book-hint '>
  <p>main.dart</p>
</blockquote><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;dart:async&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;dart:ffi&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;dart:io&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:flutter/material.dart&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:lottie/lottie.dart&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:window_manager/window_manager.dart&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// DLL 메서드 정의
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typedef</span> StartHookThreadC <span style="color:#f92672">=</span> Void Function();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> StartHookThreadDart <span style="color:#f92672">=</span> <span style="color:#66d9ef">void</span> Function();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// main
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> main() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>  WidgetsFlutterBinding.ensureInitialized();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">await</span> windowManager.ensureInitialized();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">await</span> windowManager.waitUntilReadyToShow(
</span></span><span style="display:flex;"><span>    WindowOptions(
</span></span><span style="display:flex;"><span>      skipTaskbar: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      alwaysOnTop: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      fullScreen: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      backgroundColor: Colors.transparent,
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    () <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">await</span> windowManager.setIgnoreMouseEvents(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">await</span> windowManager.setPosition(Offset.zero);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">await</span> windowManager.show();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      debugPrint(<span style="color:#e6db74">&#34;✅ Window manager initialized&#34;</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  debugPrint(<span style="color:#e6db74">&#34;📦 Loading DLL...&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> dylib <span style="color:#f92672">=</span> DynamicLibrary.open(<span style="color:#e6db74">&#39;click_hooking.dll&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> StartHookThreadDart startHookThread <span style="color:#f92672">=</span> dylib
</span></span><span style="display:flex;"><span>      .lookupFunction<span style="color:#f92672">&lt;</span>StartHookThreadC, StartHookThreadDart<span style="color:#f92672">&gt;</span>(<span style="color:#e6db74">&#39;StartHookThread&#39;</span>);
</span></span><span style="display:flex;"><span>  startHookThread();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  debugPrint(<span style="color:#e6db74">&#34;🔗 Setting mouse hook...&#34;</span>);
</span></span><span style="display:flex;"><span>  startHookThread();
</span></span><span style="display:flex;"><span>  debugPrint(<span style="color:#e6db74">&#34;✅ Mouse hook thread started&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  runApp(<span style="color:#66d9ef">const</span> MyApp());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//MyApp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyApp</span> <span style="color:#66d9ef">extends</span> StatelessWidget {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> MyApp({<span style="color:#66d9ef">super</span>.key});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  Widget build(BuildContext context) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> MaterialApp(
</span></span><span style="display:flex;"><span>      debugShowCheckedModeBanner: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      home: LayoutBuilder(
</span></span><span style="display:flex;"><span>        builder: (context, constraints) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> SizedBox(
</span></span><span style="display:flex;"><span>            width: constraints.maxWidth,
</span></span><span style="display:flex;"><span>            height: constraints.maxHeight,
</span></span><span style="display:flex;"><span>            child: ClickEffectOverlay(),
</span></span><span style="display:flex;"><span>          );
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      ),
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClickEffectOverlay</span> <span style="color:#66d9ef">extends</span> StatefulWidget {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> ClickEffectOverlay({<span style="color:#66d9ef">super</span>.key});
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  State<span style="color:#f92672">&lt;</span>ClickEffectOverlay<span style="color:#f92672">&gt;</span> createState() <span style="color:#f92672">=&gt;</span> _ClickEffectOverlayState();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">_ClickEffectOverlayState</span> <span style="color:#66d9ef">extends</span> State<span style="color:#f92672">&lt;</span>ClickEffectOverlay<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>_ClickEffect<span style="color:#f92672">&gt;</span> _effects <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> initState() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">super</span>.initState();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    WidgetsBinding.instance.addPostFrameCallback((_) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">final</span> size <span style="color:#f92672">=</span> MediaQuery.of(context).size;
</span></span><span style="display:flex;"><span>      debugPrint(<span style="color:#e6db74">&#34;📏 화면 크기: </span><span style="color:#e6db74">${</span>size.width<span style="color:#e6db74">}</span><span style="color:#e6db74"> x </span><span style="color:#e6db74">${</span>size.height<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    _startListeningForMessages();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> _startListeningForMessages() {
</span></span><span style="display:flex;"><span>    debugPrint(<span style="color:#e6db74">&#34;📡 Start listening for click coordinates...&#34;</span>);
</span></span><span style="display:flex;"><span>    Timer.periodic(<span style="color:#66d9ef">const</span> Duration(milliseconds: <span style="color:#ae81ff">100</span>), (_) {
</span></span><span style="display:flex;"><span>      _readClickPosition();
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> _readClickPosition() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> file <span style="color:#f92672">=</span> File(<span style="color:#e6db74">&#39;C:/Temp/click_position.txt&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">await</span> file.exists()) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">final</span> content <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> file.readAsString();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">final</span> parts <span style="color:#f92672">=</span> content.trim().split(<span style="color:#e6db74">&#39;,&#39;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (parts.length <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> xRaw <span style="color:#f92672">=</span> <span style="color:#66d9ef">double</span>.tryParse(parts[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> yRaw <span style="color:#f92672">=</span> <span style="color:#66d9ef">double</span>.tryParse(parts[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (xRaw <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> yRaw <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> xRaw <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> yRaw <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">// MediaQuery로 DPI 값 얻기
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">final</span> dpiScale <span style="color:#f92672">=</span> MediaQuery.of(context).devicePixelRatio;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">// 클릭 위치를 DPI 스케일에 맞게 변환
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">final</span> x <span style="color:#f92672">=</span> xRaw <span style="color:#f92672">/</span> dpiScale;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">final</span> y <span style="color:#f92672">=</span> yRaw <span style="color:#f92672">/</span> dpiScale;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          debugPrint(<span style="color:#e6db74">&#39;📍 Scaled click: x = </span><span style="color:#e6db74">$</span>x<span style="color:#e6db74">, y = </span><span style="color:#e6db74">$</span>y<span style="color:#e6db74">&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          _showClickEffect(Offset(x, y));
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">await</span> file.writeAsString(<span style="color:#e6db74">&#39;0,0&#39;</span>); <span style="color:#75715e">// 중복 방지
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> _showClickEffect(Offset offset) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 화면 크기 내에서만 애니메이션을 표시하도록 조건 추가
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (offset.dx <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> offset.dy <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> offset.dx <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1920</span> <span style="color:#f92672">||</span> offset.dy <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1080</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    setState(() {
</span></span><span style="display:flex;"><span>      _effects.add(_ClickEffect(offset));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Timer(<span style="color:#66d9ef">const</span> Duration(milliseconds: <span style="color:#ae81ff">800</span>), () {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (_effects.isNotEmpty) {
</span></span><span style="display:flex;"><span>        setState(() {
</span></span><span style="display:flex;"><span>          _effects.removeAt(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  Widget build(BuildContext context) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> size <span style="color:#f92672">=</span> MediaQuery.of(context).size;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> ratio <span style="color:#f92672">=</span> MediaQuery.of(context).devicePixelRatio;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    debugPrint(<span style="color:#e6db74">&#34;📐 화면 크기: </span><span style="color:#e6db74">${</span>size.width<span style="color:#e6db74">}</span><span style="color:#e6db74"> x </span><span style="color:#e6db74">${</span>size.height<span style="color:#e6db74">}</span><span style="color:#e6db74">, DPI: </span><span style="color:#e6db74">$</span>ratio<span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Container(
</span></span><span style="display:flex;"><span>      color: Color.fromRGBO(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0.01</span>),
</span></span><span style="display:flex;"><span>      child: Stack(
</span></span><span style="display:flex;"><span>        children: [          
</span></span><span style="display:flex;"><span>          ..._effects
</span></span><span style="display:flex;"><span>              .where(
</span></span><span style="display:flex;"><span>                (e) <span style="color:#f92672">=&gt;</span>
</span></span><span style="display:flex;"><span>                    e.offset.dx <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                    e.offset.dx <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1920</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                    e.offset.dy <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>                    e.offset.dy <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1080</span>,
</span></span><span style="display:flex;"><span>              )
</span></span><span style="display:flex;"><span>              .map((e) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Positioned(
</span></span><span style="display:flex;"><span>                  left: e.offset.dx <span style="color:#f92672">-</span> <span style="color:#ae81ff">50</span>,
</span></span><span style="display:flex;"><span>                  top: e.offset.dy <span style="color:#f92672">-</span> <span style="color:#ae81ff">50</span>,
</span></span><span style="display:flex;"><span>                  child: SizedBox(
</span></span><span style="display:flex;"><span>                    width: <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                    height: <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                    child: Lottie.asset(<span style="color:#e6db74">&#39;assets/click2.json&#39;</span>),
</span></span><span style="display:flex;"><span>                  ),
</span></span><span style="display:flex;"><span>                );
</span></span><span style="display:flex;"><span>              })
</span></span><span style="display:flex;"><span>              .toList(),
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>      ),
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">_ClickEffect</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> Offset offset;
</span></span><span style="display:flex;"><span>  _ClickEffect(<span style="color:#66d9ef">this</span>.offset);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p> <br>
 </p>
<hr>
<h2 id="result">
  Result
  <a class="anchor" href="#result">#</a>
</h2>
<p>For click motions, a simple one-time animation is enough. You don’t need Rive animations, and LottieFiles provides animations you can download and use easily without much effort.</p>
<p>The GIF below shows the result with a Lottie animation. The quality isn’t bad at all—though the GIF format makes it look slightly choppy.</p>
<p><img src="https://blog.kakaocdn.net/dna/GKsui/btsMUY27kt1/AAAAAAAAAAAAAAAAAAAAAPVNtwO-T-3Kq7n8xSkR16Un5p_3RQFLP8TcRVL4-258/img.gif?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1756652399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2F8q0gzRXvfb9knh3MrynYcXMJPU%3D" alt="&ldquo;image&rdquo;" title="image"/></p>
<p>Should I add a separate button to change the animation?<br>
Should right-clicks have a separate animation?</p>
<p>No. That was just my thought process—so let’s leave it cleanly here.</p>
<p>The End.</p>
<p> 

<a
   href="https://sunnybong.tistory.com/895" 
   target="_blank" rel="noopener" 
  class="book-btn"
>original post (Kor)</a>

 </p>
<hr>
</article>
 
      



<div class="flex flex-wrap justify-between">
  <span class="flex justify-start">
      
    <a href="https://mcjoi.github.io/flutter/05002/" class="flex align-center book-icon">
      <img src="https://mcjoi.github.io/svg/backward.svg" class="book-icon" alt="Next" />
      <span>[result] Windows Desktop Shortcut</span>
    </a>
  
  </span>
  
  <span class="flex justify-end">
  
    
    <a href="https://mcjoi.github.io/flutter/05004/" class="flex align-center book-icon">
      <span>[note] Hiding Google API key</span>
      <img src="https://mcjoi.github.io/svg/forward.svg" class="book-icon" alt="Previous" />
    </a>
  
  </span>
</div>


      

      

      

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-it">What is it?</a></li>
    <li><a href="#two-scenarios">Two Scenarios</a></li>
    <li><a href="#win32-and-ffi">Win32 and FFI</a></li>
    <li><a href="#scenario-details">Scenario Details</a></li>
    <li><a href="#packages-used">Packages Used</a></li>
    <li><a href="#calling-the-dll">Calling the DLL</a></li>
    <li><a href="#lottie-animation">Lottie Animation</a></li>
    <li><a href="#result">Result</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  

  
  

</body>
</html>












